<!-- 
/*
 * Copyright 2011 Intel Corporation.
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms and conditions of the GNU Lesser General Public License,
 * version 2.1, as published by the Free Software Foundation.
 *
 * This program is distributed in the hope it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for
 * more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program; if not, write to the Free Software Foundation,
 * Inc., 51 Franklin St - Fifth Floor, Boston, MA 02110-1301 USA.
 * Boston, MA 02111-1307, USA.
 *
 */
-->
<html>
<head>
<title>Media explorer 5-way</title>
<script src="http://code.jquery.com/jquery-1.6.1.min.js" type="text/javascript"></script>
<!-- JS version of clutter key value mappings clutter/clutter-keysyms.h -->
<script src="clutter-keysyms.js" type="text/javascript"></script>

<!-- Media explorer mappings mex/mex-main.h -->
<script type="text/javascript">
var MEX_KEY_BACK = CLUTTER_KEY_Escape;
var MEX_KEY_HOME = CLUTTER_KEY_Super_L;
var MEX_KEY_INFO = CLUTTER_KEY_Menu;

var current;
var playing = new String;

function media_player_get (thingtoget)
{
  var result;

  $.ajax ({
          url: "/",
          type: "POST",
          dataType: "text",
          timeout: 5000,
          data: 'mediaplayerget='+thingtoget,
          success: function (data) {
            if (thingtoget == "uri") {
              $("#currentplaying").html (data);
            }
          }
   });
}

function open_div (div)
{
  if (current)
    {
      $(current).hide ('slow');
    }

  if (div == "#mediaplayer")
    {
      if (playing.length > 0)
        {
          $("#currentplaying").html (playing);
          playing = "";
        }
      else
        {
          /* fallback to the uri as the "current playing" */
          media_player_get ("uri");
        }
    }

  $(div).show('slow');
  current = div;
}

function media_player_action (action)
{
  $.post ("/", { playeraction: action });
}

function media_player_set_uri (uri)
{
  $.post ("/", { setmedia: uri });
}


function clear_search_results ()
{
  /* remove any existing results */

  $("#results > button").each (function (i) {
                               $(this).remove();
                               });
  $("#results > br").each (function (i) {
                           $(this).remove();
                           });

  $("#clearbutton").attr ("style", "display: none");
}


function add_result_to_page (element)
{
  /* create new html element to add to page */
  $("<button />", {
    "class": "result",
    text: element.title,
    click: function(){

    playing = element.title;
    media_player_set_uri (element.url);

    open_div ("#mediaplayer");
  }
  }).appendTo("#results");

  $("#results").append ("<br />");

  }


function run_search ()
{
  var searchterm;
  var results;

  clear_search_results ();

  searchterm = $("#searchwords").val();

  $("#results").append ('<span id="spinner">Searching... <img src="./mex-spinner.gif" alt="searching.." /></span>');


  $.ajax ({
          url: "/",
          type: "POST",
          dataType: "text",
          timeout: 5000,
          data: 'trackersearch='+searchterm,
          success: function (data)
          {
            $("#spinner").remove();

            var results = $.parseJSON (data);
            $.each (results, function (index, element)
                    {
                      add_result_to_page (element);
                    }
                    );
          }
   });

  /* Add a button to clear the results */

  $("#clearbutton").attr ("style", "display: inline");

}
</script>
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=2, maximum-scale=1, user-scalable=no">
<style type="text/css">

body
{
  margin: 0 auto;
  color: #ffffff;
  background-color: #000000;
}


button,
input
{
  color: #ffffff;
  background: url("/DATADIR/style/panel-header-bg.png");
  background-repeat: repeat-x;
  border: none;
  padding: 1.2em;
}

.remote-button
{
  width: 5em;
}

.result
{
  width: 100%;
  margin: 0 0 0.5em 0;
}

button:hover,
input:hover
{
  color: #000000;
  background: url("/DATADIR/style/highlight-bg.png");
  background-repeat: repeat-x;
}

#remote,
#search,
#mediaplayer
{
  display: none;
}

a
{
  color: #ffffff;
}

#mediaplayer > button
{
  padding: 0 0 1em 0;
}

#menu
{
  width: 100%;
  background: url("/DATADIR/style/item-title-bg.png");
  background-repeat: repeat-x;
  padding: 1em;
}

</style>
</head>

<body OnLoad="open_div ('#remote');" >
<div id="menu">
<a href="#" OnClick="open_div ('#remote');">5-Way remote</a>
  <a href="#" OnClick="open_div ('#search');">Search</a>
  <a href="#" OnClick="open_div ('#mediaplayer');">Media Player</a>
</div>
<hr />

<div id="remote">
<center>
<form method="POST" action="">
<table>
<tr>
<td></td>
<!-- uses the names from clutter-keysyms.h -->
<td><input name="keyvalue" class="remote-button" type="button" onClick="$.post('/', { keyvalue: CLUTTER_KEY_Up})" value="Up" /></td>
<td><td>
</tr>
<td><input name="keyvalue" class="remote-button" type="button" onClick="$.post('/', { keyvalue: CLUTTER_KEY_Left})" value="Left" /></td>
<td><input name="keyvalue" class="remote-button" type="button" onClick="$.post('/', { keyvalue: CLUTTER_KEY_Return})" value="Enter" /></td>
<td><input name="keyvalue" class="remote-button" type="button" onClick="$.post('/', { keyvalue: CLUTTER_KEY_Right})" value="Right" /></td>
<tr>
<td></td>
<td><input name="keyvalue" class="remote-button" type="button" onClick="$.post('/', { keyvalue: CLUTTER_KEY_Down})" value="Down" /></td>
<td><td>
</tr>
</table>
<br />
<td><input name="keyvalue" class="remote-button" type="button" onClick="$.post('/', { keyvalue: MEX_KEY_INFO})" value="Info" /></td>
<td><input name="keyvalue" class="remote-button" type="button" onClick="$.post('/', { keyvalue: MEX_KEY_BACK})" value="Back" /></td>
<td><input name="keyvalue" class="remote-button" type="button" onClick="$.post('/', { keyvalue: MEX_KEY_HOME})" value="Home" /></td>
</center>
</form>
</div>

<div id="search">
<img src="/DATADIR/style/icons/mex/26x26/icon-panelheader-search.png" alt="search icon" />
<input type="text" name="trackersearch" id="searchwords" style="width: 10em" />
<button onClick="run_search ();" >Search</button>
<button id="clearbutton" style="display: none;" onClick="clear_search_results ();">Clear</button>
<br />
<br />
<div id="results">
</div>

</div>

<div id="mediaplayer">

<p id="currentplaying"></p>
<input type="button" value="Back" OnClick="media_player_action ('seekbk');" />

<input type="button" value="Play/Pause" OnClick="media_player_action ('playpause');" />
<input type="button" value="Fwd" OnClick="media_player_action ('seekfwd');" />
<br />
<br />
</div>


</body>
</html>

